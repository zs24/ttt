<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>reconHRRT: Image.hpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.5 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a>  | <span class="search"><u>S</u>earch&nbsp;for&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<h1>Image.hpp</h1><div class="fragment"><pre>00001 
00016 <span class="preprocessor">#ifndef IMAGE_HPP</span>
00017 <span class="preprocessor"></span><span class="preprocessor">#define IMAGE_HPP</span>
00018 <span class="preprocessor"></span><span class="preprocessor">#include &lt;string&gt;</span>
00019 <span class="preprocessor">#include &lt;map&gt;</span>
00020 <span class="preprocessor">#include &lt;iostream&gt;</span>
00021 <span class="preprocessor">#include "array.hpp"</span>
00022 <span class="preprocessor">#include "Params.hpp"</span>
00023 <span class="preprocessor">#include "XMLTree.hpp"</span>
00024 
<a name="l00025"></a><a class="code" href="classImage.html">00025</a> <span class="keyword">class </span><a class="code" href="classImage.html">Image</a> : <span class="keyword">public</span> <a class="code" href="classArray3D.html">Array3D</a>&lt;float&gt; {
00026 
00027 <span class="keyword">public</span>:
00028   <span class="comment">// Constructors</span>
00029 
00030 
00048   <a class="code" href="classImage.html#a0">Image</a>(<a class="code" href="structParams_1_1Geometry.html">Params::Geometry</a> &amp;geometry, string fileType, string dataType);
00049 
00064   <a class="code" href="classImage.html#a0">Image</a>(string filename, string fileType, string dataType,
00065         <a class="code" href="structParams_1_1Extensions.html">Params::Extensions</a> &amp;extensions); 
00066 
00075   <a class="code" href="classImage.html#a0">Image</a>(<span class="keywordtype">int</span> dim1, <span class="keywordtype">int</span> dim2, <span class="keywordtype">int</span> dim3); <span class="comment">// To call Array3D constructor</span>
00076 
00077   <span class="comment">// Copy constructors</span>
00078 
00087   <a class="code" href="classImage.html#a0">Image</a>(<a class="code" href="classImage.html">Image</a>&amp; img);
00088 
00097   <a class="code" href="classImage.html">Image</a>&amp; <a class="code" href="classImage.html#a4">operator=</a>(<a class="code" href="classImage.html">Image</a>&amp; img);
00098 
00099   <span class="comment">// Access the types</span>
00100 
00109   string <a class="code" href="classImage.html#a5">getFileType</a>();
00118   string <a class="code" href="classImage.html#a6">getDataType</a>();
00119 
00120   <span class="comment">// Read function, which is context dependent, i.e., if</span>
00121   <span class="comment">// dataType == "Dicom" will read a dicom image</span>
00134 <span class="comment"></span>  <span class="keywordtype">bool</span> <a class="code" href="classImage.html#a7">read</a>(string filename, <a class="code" href="structParams_1_1Extensions.html">Params::Extensions</a> &amp;ext);  
00135   <span class="comment">// true if successful, false if not</span>
00136         
00137   <span class="comment">// Write function, also context-dependent</span>
00138   <span class="comment">// Writing the status file into the Image header file.</span>
00139   <span class="comment">//bool write(string filename, Params &amp;params, Params::Extensions &amp;ext);</span>
00140   <span class="comment">//bool write(string filename, Status &amp;status, Params::Extensions &amp;ext);</span>
00141   <span class="comment">//Note: "filename" should be the header file name, the data file is </span>
00142   <span class="comment">//generated </span>
00143   <span class="comment">//with extension ".raw"</span>
00158 <span class="comment"></span>  <span class="keywordtype">bool</span> <a class="code" href="classImage.html#a8">write</a>(string filename, <a class="code" href="structParams_1_1Extensions.html">Params::Extensions</a> &amp;ext,<a class="code" href="classImage.html">Image</a> &amp;Q,  
00159              Params &amp;params, <a class="code" href="classArray3D.html">Array3D&lt;char&gt;</a> &amp;lambdaMask);
00160 
00161   <span class="keywordtype">bool</span> <a class="code" href="classImage.html#a8">write</a>(string filename, <a class="code" href="structParams_1_1Extensions.html">Params::Extensions</a> &amp;ext);
00162 
00163   <span class="comment">//A generic function to insert any XMLTree into the Image XML Header</span>
00182 <span class="comment"></span>  <span class="keywordtype">bool</span> <a class="code" href="classImage.html#a8">write</a>(string filename, XMLTree &amp;newTree, <a class="code" href="structParams_1_1Extensions.html">Params::Extensions</a> &amp;ext);
00183 
<a name="l00189"></a><a class="code" href="classImage.html#o0">00189</a>   XMLTree <a class="code" href="classImage.html#o0">xml</a>;
00190   
00197   <span class="keywordtype">float</span> * <a class="code" href="classImage.html#a11">getOrderSlice</a>( <span class="keywordtype">int</span> iz);
00198   
00206   <span class="keywordtype">void</span> <a class="code" href="classImage.html#a12">putOrderSlice</a>( <span class="keywordtype">int</span> iz,  <span class="keywordtype">float</span>* array);
00212   <span class="keywordtype">float</span> <a class="code" href="classImage.html#a13">getSliceAverage</a>(<span class="keywordtype">int</span> iz);
00213 
00218   <span class="keywordtype">void</span> <a class="code" href="classImage.html#a14">globalSum</a>(Params &amp; params);
00226   <span class="keywordtype">void</span> <a class="code" href="classImage.html#a14">globalSum</a>(<a class="code" href="classImage.html">Image</a> &amp; Q, Params &amp; params);
00232   <span class="keywordtype">void</span> <a class="code" href="classImage.html#a16">scale</a>(Params &amp; params, <span class="keywordtype">float</span> coeff);
00233 
00234 <span class="keyword">private</span>:
00235 
00236 
00240   <span class="keyword">struct </span>fileInfo {
00241     <span class="keyword">struct </span>dataset_attr { <span class="comment">// Required Field</span>
00242       <a class="code" href="structParams_1_1Extensions.html">Params::Extensions</a> ext;
00243       <span class="keywordtype">int</span> nDimensions;
00244       string fileType;
00245       string hdrFileName; 
00246       string dataFileName; <span class="comment">// Image data file name</span>
00247       <span class="keywordtype">int</span> imageOffset;
00248       string dataType; <span class="comment">//right now only "Float" supported</span>
00249       <span class="keywordtype">bool</span> endianess; <span class="comment">//required</span>
00250       <span class="keywordtype">int</span> extents[5]; <span class="comment">//require hardcoded to 3-dim</span>
00251       <span class="keywordtype">float</span> resolutions[5]; <span class="comment">//require  hardcoded to 3-dim</span>
00252       <span class="keywordtype">int</span> slice_spacing;
00253       string units[5]; <span class="comment">//require  hardcoded to 3-dim</span>
00254       string orientation;
00255       string subject_axis_orientation[5];  <span class="comment">//require  hardcoded to 3-dim</span>
00256       <span class="keywordtype">float</span> start_locations[5];  <span class="comment">//require  hardcoded to 3-dim</span>
00257     } dataset_attr; <span class="comment">//required</span>
00258     <span class="keyword">struct </span>subject_info {
00259       string subject_name;
00260       string race;
00261       string subject_id; <span class="comment">//required</span>
00262       string diagnosis;
00263       string data_of_birth;
00264       string height;
00265       string weight;
00266       string sex;
00267       string body_part;
00268     } subject_info;
00269     <span class="keyword">struct </span>scan_attr {
00270       string equipment_model_name;
00271       string scan_id;
00272       string protocol;
00273       string scan_date_time; <span class="comment">//required </span>
00274     } scan_attr;
00275     <span class="keyword">struct </span>investigators {
00276       string investigator_name; <span class="comment">//required</span>
00277       string title;
00278       string affliation;
00279       string email;
00280       string phone;
00281     } investigators[3];
00282   } imageFileInfo;
00283 
00284 
00290   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> GRAY1_BOOLEAN = 1;
00291   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> GRAY8_BYTE = 2;
00292   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> GRAY8_UNSIGNED_BYTE = 3;
00293   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> GRAY16_SHORT = 4;
00294   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> GRAY16_UNSIGNED_SHORT = 5;
00295   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> GRAY32_INT = 6;
00296   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> GRAY32_UNSIGNED_INT = 7;
00297   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> GRAY32_FLOAT = 8;
00298   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> GRAY32_UNSIGNED_FLOAT = 9;
00299   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> GRAY64_DOUBLE = 10;
00300   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> GRAY64_UNSIGNED_DOUBLE = 11;
00301   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> GRAY64_RGB = 12;
00302 
00303   <span class="comment">// Endianness</span>
00304   <span class="comment">// little endian - byte order is LSB-&gt;MSB</span>
00305   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">bool</span> L_ENDIAN = <span class="keyword">true</span>;
00306   <span class="comment">// big endian - byte order is MSB-&gt;LSB</span>
00307   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">bool</span> B_ENDIAN = <span class="keyword">false</span>;
00308 
00317   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> XML = 1;
00318   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> ANALYZE = 2;
00319   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> INTERFILE = 3;
00320   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> DICOM = 4;
00321   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> RAW = 5;
00322 
00326   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> DIMENSIONS = 3;
00327 
00328   <span class="comment">// Analyze Reader Stuff</span>
00329   <span class="comment">/* Acceptable values for datatype */</span>
00330 <span class="preprocessor">#define DT_NONE 0</span>
00331 <span class="preprocessor"></span><span class="preprocessor">#define DT_UNKNOWN 0</span>
00332 <span class="preprocessor"></span><span class="preprocessor">#define DT_BINARY 1</span>
00333 <span class="preprocessor"></span><span class="preprocessor">#define DT_UNSIGNED_CHAR 2</span>
00334 <span class="preprocessor"></span><span class="preprocessor">#define DT_SIGNED_SHORT 4</span>
00335 <span class="preprocessor"></span><span class="preprocessor">#define DT_SIGNED_INT 8</span>
00336 <span class="preprocessor"></span><span class="preprocessor">#define DT_FLOAT 16</span>
00337 <span class="preprocessor"></span><span class="preprocessor">#define DT_COMPLEX 32</span>
00338 <span class="preprocessor"></span><span class="preprocessor">#define DT_DOUBLE 64</span>
00339 <span class="preprocessor"></span><span class="preprocessor">#define DT_RGB 128</span>
00340 <span class="preprocessor"></span><span class="preprocessor">#define DT_ALL 255</span>
00341 <span class="preprocessor"></span>
00351   <span class="keywordtype">int</span> readInt(ifstream &amp;fs, <span class="keywordtype">bool</span> littlendian);
00361   <span class="keywordtype">float</span> readFloat(ifstream &amp;fs, <span class="keywordtype">bool</span> littlendian);
00371   <span class="keywordtype">short</span> readShort(ifstream &amp;fs, <span class="keywordtype">bool</span> littlendian);
00372         
00382   <span class="keywordtype">void</span> writeInt(ofstream &amp;input , <span class="keywordtype">int</span> value);
00392   <span class="keywordtype">void</span> writeShort(ofstream &amp;input , <span class="keywordtype">short</span> value);
00402   <span class="keywordtype">void</span> writeFloat(ofstream &amp;input , <span class="keywordtype">float</span> value);
00403 
00412   <span class="keywordtype">int</span> setDataType(string dataType);
00421   <span class="keywordtype">int</span> setFileType();
00429   string getEndianess();
00437   <span class="keywordtype">void</span> setEndianess(string Endian);
00438 
00449   <span class="keywordtype">bool</span> readHdr();
00459   <span class="keywordtype">bool</span> xmlReadHdr();
00468   <span class="keywordtype">bool</span> xmlWriteHdr();
00469 
00474   <span class="keywordtype">bool</span> dicomReadHdr();
00475 
00479   <span class="keywordtype">bool</span> dicomWriteHdr();
00488   <span class="keywordtype">bool</span> analyzeReadHdr();
00497   <span class="keywordtype">bool</span> analyzeWriteHdr();
00506   <span class="keywordtype">bool</span> interfileReadHdr();
00507 
00512   <span class="keywordtype">bool</span> interfileWriteHdr();
00513 
00521   <span class="keywordtype">bool</span> readData();
00529   <span class="keywordtype">bool</span> writeData();
00530         
00538   <span class="keywordtype">void</span> showFileHeader();
00549   string getReqdAttributes(string attributes, string searchstr);
00561   <span class="keywordtype">bool</span> setReqdAttributes(string &amp;attributes, string searchstr, 
00562                          string value);
00570   <span class="keywordtype">bool</span> buildXMLTree();
00578   <span class="keywordtype">int</span> pixelBytes();
00579 
00580 
00584 <span class="preprocessor">#define DEBUGL 5</span>
00585 <span class="preprocessor"></span><span class="preprocessor">#define SEVERE 0</span>
00586 <span class="preprocessor"></span><span class="preprocessor">#define HIGH 1</span>
00587 <span class="preprocessor"></span><span class="preprocessor">#define MEDIUM 2</span>
00588 <span class="preprocessor"></span><span class="preprocessor">#define LOW 3</span>
00589 <span class="preprocessor"></span><span class="preprocessor">#define INFO 0</span>
00590 <span class="preprocessor"></span>
00591 };
00592 <span class="preprocessor">#endif </span><span class="comment">/* IMAGE_HPP */</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Thu Dec 13 14:13:47 2007 for reconHRRT by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.5 </small></address>
</body>
</html>
