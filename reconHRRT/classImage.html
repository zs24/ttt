<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>reconHRRT: Image class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.5 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a>  | <span class="search"><u>S</u>earch&nbsp;for&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<h1>Image Class Reference</h1><code>#include &lt;<a class="el" href="Image_8hpp-source.html">Image.hpp</a>&gt;</code>
<p>
<p>Inheritance diagram for Image:
<p><center><img src="classImage.png" usemap="#Image_map" border="0" alt=""></center>
<map name="Image_map">
<area href="classArray3D.html" alt="Array3D< float >" shape="rect" coords="0,0,109,24">
</map>
<a href="classImage-members.html">List of all members.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classImage.html#a0">Image</a> (<a class="el" href="structParams_1_1Geometry.html">Params::Geometry</a> &amp;geometry, string fileType, string dataType)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">: Image class implementation  <a href="#a0"></a><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classImage.html#a1">Image</a> (string filename, string fileType, string dataType, <a class="el" href="structParams_1_1Extensions.html">Params::Extensions</a> &amp;extensions)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classImage.html#a2">Image</a> (int dim1, int dim2, int dim3)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classImage.html#a3">Image</a> (<a class="el" href="classImage.html">Image</a> &amp;img)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="classImage.html">Image</a> &amp;&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classImage.html#a4">operator=</a> (<a class="el" href="classImage.html">Image</a> &amp;img)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>string&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classImage.html#a5">getFileType</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>string&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classImage.html#a6">getDataType</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>bool&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classImage.html#a7">read</a> (string filename, <a class="el" href="structParams_1_1Extensions.html">Params::Extensions</a> &amp;ext)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>bool&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classImage.html#a8">write</a> (string filename, <a class="el" href="structParams_1_1Extensions.html">Params::Extensions</a> &amp;ext, <a class="el" href="classImage.html">Image</a> &amp;Q, Params &amp;params, <a class="el" href="classArray3D.html">Array3D</a>&lt; char &gt; &amp;lambdaMask)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="anchor" name="a9" doxytag="Image::write" ></a>
bool&nbsp;</td><td class="memItemRight" valign=bottom><b>write</b> (string filename, <a class="el" href="structParams_1_1Extensions.html">Params::Extensions</a> &amp;ext)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>bool&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classImage.html#a10">write</a> (string filename, XMLTree &amp;newTree, <a class="el" href="structParams_1_1Extensions.html">Params::Extensions</a> &amp;ext)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>float *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classImage.html#a11">getOrderSlice</a> (int iz)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classImage.html#a12">putOrderSlice</a> (int iz, float *array)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>float&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classImage.html#a13">getSliceAverage</a> (int iz)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classImage.html#a14">globalSum</a> (Params &amp;params)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classImage.html#a15">globalSum</a> (<a class="el" href="classImage.html">Image</a> &amp;Q, Params &amp;params)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classImage.html#a16">scale</a> (Params &amp;params, float coeff)</td></tr>

<tr><td colspan=2><br><h2>Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>XMLTree&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classImage.html#o0">xml</a></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Image class The Image class extends <a class="el" href="classArray3D.html">Array3D</a> and supports I/O operations. As such it needs member variables to specify the image file type (i.e., "Dicom", "XML", "Analyze", etc.) as well as the data type ("int16", "int32", "float32", etc.). However, these fields are protected since they are read-only and can only be set at construction time. The image data are stored internally as floats. Accessor methods are provided for those protected fields.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="classArray3D.html">Array3D</a>, Params </dd></dl>

<p>

<p>
Definition at line <a class="el" href="Image_8hpp-source.html#l00025">25</a> of file <a class="el" href="Image_8hpp-source.html">Image.hpp</a>.<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="a0" doxytag="Image::Image" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> Image::Image </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structParams_1_1Geometry.html">Params::Geometry</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>geometry</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>string&nbsp;</td>
          <td class="mdname" nowrap> <em>fileType</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>string&nbsp;</td>
          <td class="mdname" nowrap> <em>dataType</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
: Image class implementation 
<p>
Image class constructor Constructs a new Image from geometry and the specified types. Initialises a 3D float array with 0's. Dimensions of the array are (geometry.nX,geometry.nY, geometry.nZ) Also constructs a XML header file(as an XMLTree) with the following defaults: Dimensions: (geometry.nX,geometry.nY, geometry.nZ) Pixel Dimensions: (geometry.dX,geometry.dY, geometry.dZ) Endianess=Little <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>Geometry</em>&nbsp;</td><td>- Geometry Structure present in the Params Class fileType - Accepted values: xml, analyze, interfile, dicom, raw dataType - Accepted Values: float, int, short, byte, binary </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>N/A </dd></dl>
<dl compact><dt><b>See also:</b></dt><dd>Params </dd></dl>

<p>
Definition at line <a class="el" href="Image_8cpp-source.html#l00018">18</a> of file <a class="el" href="Image_8cpp-source.html">Image.cpp</a>.
<p>
References <a class="el" href="Params_8hpp-source.html#l00326">Params::Geometry::dX</a>, <a class="el" href="Params_8hpp-source.html#l00326">Params::Geometry::dY</a>, <a class="el" href="Params_8hpp-source.html#l00326">Params::Geometry::dZ</a>, <a class="el" href="Array3D_8hpp-source.html#l00132">Array3D&lt; float &gt;::init()</a>, <a class="el" href="Params_8hpp-source.html#l00322">Params::Geometry::nX</a>, <a class="el" href="Params_8hpp-source.html#l00322">Params::Geometry::nY</a>, <a class="el" href="Params_8hpp-source.html#l00322">Params::Geometry::nZ</a>, <a class="el" href="Params_8hpp-source.html#l00327">Params::Geometry::offsetX</a>, <a class="el" href="Params_8hpp-source.html#l00327">Params::Geometry::offsetY</a>, and <a class="el" href="Params_8hpp-source.html#l00327">Params::Geometry::offsetZ</a>.
<p>
<div class="fragment"><pre>00018                                                                        {
00019         
00020   <span class="comment">//            Image::geometry = geometry;</span>
00021   <span class="comment">//            memset(&amp;imageFileInfo, 0, sizeof(struct fileInfo));</span>
00022   imageFileInfo.dataset_attr.fileType = fileType;
00023   imageFileInfo.dataset_attr.dataType = dataType;
00024   <a class="code" href="classArray3D.html#a8">init</a>(geometry.<a class="code" href="structParams_1_1Geometry.html#o0">nX</a>, geometry.<a class="code" href="structParams_1_1Geometry.html#o1">nY</a>, geometry.<a class="code" href="structParams_1_1Geometry.html#o2">nZ</a>); <span class="comment">// Calling Array3D constructor</span>
00025   imageFileInfo.dataset_attr.extents[0] = geometry.<a class="code" href="structParams_1_1Geometry.html#o0">nX</a>;
00026   imageFileInfo.dataset_attr.extents[1] = geometry.<a class="code" href="structParams_1_1Geometry.html#o1">nY</a>;
00027   imageFileInfo.dataset_attr.extents[2] = geometry.<a class="code" href="structParams_1_1Geometry.html#o2">nZ</a>;
00028   imageFileInfo.dataset_attr.start_locations[0] = loc1 = geometry.<a class="code" href="structParams_1_1Geometry.html#o8">offsetX</a>;
00029   imageFileInfo.dataset_attr.start_locations[1] = loc2 = geometry.<a class="code" href="structParams_1_1Geometry.html#o9">offsetY</a>;
00030   imageFileInfo.dataset_attr.start_locations[2] = loc3 = geometry.<a class="code" href="structParams_1_1Geometry.html#o10">offsetZ</a>;
00031   step1 = geometry.<a class="code" href="structParams_1_1Geometry.html#o5">dX</a>;
00032   step2 = geometry.<a class="code" href="structParams_1_1Geometry.html#o6">dY</a>;
00033   step3 = geometry.<a class="code" href="structParams_1_1Geometry.html#o7">dZ</a>;
00034   imageFileInfo.dataset_attr.resolutions[0] = geometry.<a class="code" href="structParams_1_1Geometry.html#o5">dX</a>;
00035   imageFileInfo.dataset_attr.resolutions[1] = geometry.<a class="code" href="structParams_1_1Geometry.html#o6">dY</a>;
00036   imageFileInfo.dataset_attr.resolutions[2] = geometry.<a class="code" href="structParams_1_1Geometry.html#o7">dZ</a>;
00037   <span class="comment">// Dont know how to initialise step_units &amp; imageFileInfo.dataset_attr.units for blank image-hardcoding to Millimeters        </span>
00038   imageFileInfo.dataset_attr.units[0] = step_units1 = <span class="stringliteral">"Millimeters"</span>;
00039   imageFileInfo.dataset_attr.units[1] = step_units2 = <span class="stringliteral">"Millimeters"</span>;
00040   imageFileInfo.dataset_attr.units[2] = step_units3 = <span class="stringliteral">"Millimeters"</span>;
00041                 
00042   <span class="comment">// Dont know how to initialise endianess</span>
00043   imageFileInfo.dataset_attr.endianess = L_ENDIAN;
00044   imageFileInfo.dataset_attr.imageOffset = 0;
00045   imageFileInfo.dataset_attr.slice_spacing = 0;
00046   imageFileInfo.dataset_attr.nDimensions = DIMENSIONS; <span class="comment">// Hardcoding Dimensions;</span>
00047   imageFileInfo.dataset_attr.orientation = <span class="stringliteral">"Unknown"</span>;
00048   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0 ; i &lt; imageFileInfo.dataset_attr.nDimensions ; i++) {
00049     imageFileInfo.dataset_attr.subject_axis_orientation[i] = <span class="stringliteral">"Unknown"</span>;
00050   }
00051                 
00052   <span class="comment">//Build the XML tree here</span>
00053   buildXMLTree();
00054 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="Image::Image" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> Image::Image </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">string&nbsp;</td>
          <td class="mdname" nowrap> <em>filename</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>string&nbsp;</td>
          <td class="mdname" nowrap> <em>fileType</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>string&nbsp;</td>
          <td class="mdname" nowrap> <em>dataType</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="structParams_1_1Extensions.html">Params::Extensions</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>extensions</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Image class constructor Constructs the image array by reading the specified file. The file type of the input file is determined by the Extensions structure <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>filename</em>&nbsp;</td><td>- Input Image filename fileType - Accepted values: xml, analyze, interfile, dicom, raw dataType - Accepted Values: float, int, short, byte, binary Extensions - Contains the accepted extensions for the different file types </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>N/A </dd></dl>
<dl compact><dt><b>See also:</b></dt><dd>Params </dd></dl>

<p>
Definition at line <a class="el" href="Image_8cpp-source.html#l00056">56</a> of file <a class="el" href="Image_8cpp-source.html">Image.cpp</a>.
<p>
References <a class="el" href="Log_8hpp-source.html#l00079">Log::getLog()</a>, <a class="el" href="Array3D_8hpp-source.html#l00132">Array3D&lt; float &gt;::init()</a>, and <a class="el" href="Log_8hpp-source.html#l00052">Log::outputMessage()</a>.
<p>
<div class="fragment"><pre>00057                                            {
00058   <span class="comment">//memset(&amp;imageFileInfo, 0, sizeof(struct fileInfo));</span>
00059   imageFileInfo.dataset_attr.hdrFileName = filename;
00060   imageFileInfo.dataset_attr.fileType = fileType;
00061   imageFileInfo.dataset_attr.dataType = dataType;
00062   imageFileInfo.dataset_attr.ext = extensions;
00063   <span class="keywordflow">if</span> (!readHdr()) {
00064     <a class="code" href="classLog.html">Log</a> *log = <a class="code" href="classLog.html#e0">Log::getLog</a>();
00065     log-&gt;<a class="code" href="classLog.html#a2">outputMessage</a>(<span class="stringliteral">"Image(string filename, string fileType, string dataType, Params::Extensions &amp;extensions): Reading the file header:"</span>+filename+<span class="stringliteral">" failed\n"</span>, FRAME, HIGH);
00066   }
00067   <span class="comment">// Array3D variables setting</span>
00068   <span class="keywordtype">int</span> d1 = imageFileInfo.dataset_attr.extents[0];
00069   <span class="keywordtype">int</span> d2 = imageFileInfo.dataset_attr.extents[1];
00070   <span class="keywordtype">int</span> d3 = imageFileInfo.dataset_attr.extents[2];
00071   step1 = imageFileInfo.dataset_attr.resolutions[0];
00072   step2 = imageFileInfo.dataset_attr.resolutions[1];
00073   step3 = imageFileInfo.dataset_attr.resolutions[2];
00074   step_units1 = imageFileInfo.dataset_attr.units[0];
00075   step_units2 = imageFileInfo.dataset_attr.units[1];
00076   step_units3 = imageFileInfo.dataset_attr.units[2];
00077   loc1 = imageFileInfo.dataset_attr.start_locations[0];
00078   loc2 = imageFileInfo.dataset_attr.start_locations[1];
00079   loc3 = imageFileInfo.dataset_attr.start_locations[2];
00080 
00081   <a class="code" href="classArray3D.html#a8">init</a>(d1, d2, d3);
00082                 
00083   <span class="keywordflow">if</span> (!readData()) {
00084     <a class="code" href="classLog.html">Log</a> *log = <a class="code" href="classLog.html#e0">Log::getLog</a>();   
00085     log-&gt;<a class="code" href="classLog.html#a2">outputMessage</a>(<span class="stringliteral">"Image: Reading the file:"</span>+
00086                        imageFileInfo.dataset_attr.dataFileName
00087                        +<span class="stringliteral">" failed...aborting\n"</span>,FRAME,HIGH);
00088   }
00089 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="Image::Image" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> Image::Image </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>dim1</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>dim2</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>dim3</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Image class constructor Internal Constructor. Should not be used by other modules. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>dim1,dim2,dim3</em>&nbsp;</td><td>- Dimensions of the 3D Float Image Array </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>N/A </dd></dl>
<dl compact><dt><b>See also:</b></dt><dd></dd></dl>

<p>
Definition at line <a class="el" href="Image_8cpp-source.html#l00091">91</a> of file <a class="el" href="Image_8cpp-source.html">Image.cpp</a>.
<p>
<div class="fragment"><pre>00091                                    : <a class="code" href="classArray3D.html">Array3D&lt;float&gt;</a>(d1,d2,d3) {
00092   imageFileInfo.dataset_attr.dataType = <span class="stringliteral">"Float"</span>;
00093   imageFileInfo.dataset_attr.endianess = L_ENDIAN;
00094   imageFileInfo.dataset_attr.imageOffset = 0;
00095   imageFileInfo.dataset_attr.slice_spacing = 0;
00096   imageFileInfo.dataset_attr.nDimensions = DIMENSIONS; 
00097   <span class="comment">// Hardcoding Dimensions;</span>
00098   imageFileInfo.dataset_attr.orientation = <span class="stringliteral">"Unknown"</span>;
00099 
00100   imageFileInfo.dataset_attr.extents[0] = d1;
00101   imageFileInfo.dataset_attr.extents[1] = d2;
00102   imageFileInfo.dataset_attr.extents[2] = d3;
00103 
00104   step1 = imageFileInfo.dataset_attr.resolutions[0] = 1.0;
00105   step2 = imageFileInfo.dataset_attr.resolutions[1] = 1.0;
00106   step3 = imageFileInfo.dataset_attr.resolutions[2] = 1.0;
00107   <span class="comment">// Dont know how to initialise step_units &amp; </span>
00108   <span class="comment">//imageFileInfo.dataset_attr.units for blank </span>
00109   <span class="comment">//image-hardcoding to Millimeters     </span>
00110   imageFileInfo.dataset_attr.units[0] = step_units1 = <span class="stringliteral">"Millimeters"</span>;
00111   imageFileInfo.dataset_attr.units[1] = step_units2 = <span class="stringliteral">"Millimeters"</span>;
00112   imageFileInfo.dataset_attr.units[2] = step_units3 = <span class="stringliteral">"Millimeters"</span>;
00113   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0 ; i &lt; imageFileInfo.dataset_attr.nDimensions ; i++) {
00114     imageFileInfo.dataset_attr.subject_axis_orientation[i] = <span class="stringliteral">"Unknown"</span>;
00115     imageFileInfo.dataset_attr.start_locations[i] = 0.0;
00116   }
00117 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="Image::Image" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> Image::Image </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classImage.html">Image</a> &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>img</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Image class copy constructor - Makes a copy of the input Image instance <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>Image</em>&nbsp;</td><td>- Input Image instance to make copy of </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>N/A </dd></dl>
<dl compact><dt><b>See also:</b></dt><dd></dd></dl>

<p>
Definition at line <a class="el" href="Image_8cpp-source.html#l00119">119</a> of file <a class="el" href="Image_8cpp-source.html">Image.cpp</a>.
<p>
References <a class="el" href="Image_8hpp-source.html#l00189">xml</a>.
<p>
<div class="fragment"><pre>00119                        : <a class="code" href="classArray3D.html">Array3D&lt;float&gt;</a>(img) {
00120   <span class="comment">//memset(&amp;imageFileInfo, 0, sizeof(struct fileInfo));</span>
00121   <a class="code" href="classImage.html#o0">xml</a> = img.<a class="code" href="classImage.html#o0">xml</a>;
00122   imageFileInfo = img.<a class="code" href="classImage.html#r0">imageFileInfo</a>;
00123 }
</pre></div>    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="a6" doxytag="Image::getDataType" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> string Image::getDataType </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns the Output Data Type for the Image <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>-</em>&nbsp;</td><td>none </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>output Data type. Returned value could be : float, int, short, byte, binary </dd></dl>
<dl compact><dt><b>See also:</b></dt><dd></dd></dl>

<p>
Definition at line <a class="el" href="Image_8cpp-source.html#l00211">211</a> of file <a class="el" href="Image_8cpp-source.html">Image.cpp</a>.
<p>
<div class="fragment"><pre>00211                           {
00212   <span class="keywordflow">return</span> imageFileInfo.dataset_attr.dataType;
00213 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="Image::getFileType" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> string Image::getFileType </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns the Output File Type for the Image <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>-</em>&nbsp;</td><td>none </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>output file type. Returned value could be : xml, analyze, interfile, dicom, raw </dd></dl>
<dl compact><dt><b>See also:</b></dt><dd></dd></dl>

<p>
Definition at line <a class="el" href="Image_8cpp-source.html#l00215">215</a> of file <a class="el" href="Image_8cpp-source.html">Image.cpp</a>.
<p>
<div class="fragment"><pre>00215                           {
00216   <span class="keywordflow">return</span> imageFileInfo.dataset_attr.fileType;
00217 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="Image::getOrderSlice" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> float * Image::getOrderSlice </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>iz</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get a slice of image on xy plane from the 3d image object the slice will be fitted into a 1d buffer and return it <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>iz</em>&nbsp;</td><td>index in z axis </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>buffer 1d array to store the slice </dd></dl>

<p>
Definition at line <a class="el" href="Image_8cpp-source.html#l01858">1858</a> of file <a class="el" href="Image_8cpp-source.html">Image.cpp</a>.
<p>
<div class="fragment"><pre>01859 {
01860        
01861   <span class="keywordtype">int</span>  i2 = iz; <span class="comment">//z index in the middle</span>
01862   <span class="keywordflow">if</span>(i2&lt;0||dim2&lt;=i2) { <span class="comment">//check dimension</span>
01863     cout &lt;&lt; <span class="stringliteral">"Bad index "</span>&lt;&lt;i2&lt;&lt;<span class="stringliteral">"&gt; "</span>&lt;&lt;dim2&lt;&lt; endl;
01864     <span class="keywordflow">return</span>(**z);
01865   }
01866        
01867   <span class="keywordtype">float</span> * block = <span class="keyword">new</span> <span class="keywordtype">float</span> [dim1*dim3]; <span class="comment">//buffer to return</span>
01868   <span class="keywordtype">int</span> index = 0, jz= iz;
01869  
01870   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> jy = 0; jy&lt;dim3; jy++)
01871     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> jx = 0; jx&lt;dim1; jx++){
01872       block[index] = this-&gt;z[jy][jz][jx];
01873       index ++;
01874     }
01875    
01876   <span class="keywordflow">return</span> (block);
01877 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="Image::getSliceAverage" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> float Image::getSliceAverage </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>iz</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
get average value of a slice in x y direction <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>iz</em>&nbsp;</td><td>the number of the slice </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>the average value of the slice </dd></dl>

<p>
Definition at line <a class="el" href="Image_8cpp-source.html#l01883">1883</a> of file <a class="el" href="Image_8cpp-source.html">Image.cpp</a>.
<p>
<div class="fragment"><pre>01884 {
01885   <span class="keywordtype">int</span>  i2 = jz; <span class="comment">//z index in the middle</span>
01886   <span class="keywordflow">if</span>(i2&lt;0||dim2&lt;=i2) { <span class="comment">//check dimension</span>
01887     cout &lt;&lt; <span class="stringliteral">"Bad index &lt;"</span>&lt;&lt;i2&lt;&lt;<span class="stringliteral">"&gt; "</span>&lt;&lt;dim2&lt;&lt; endl;
01888     <span class="keywordflow">return</span> 0;
01889   }
01890   <span class="keywordtype">float</span> avg = 0;
01891   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> jy = 0; jy&lt;dim3; jy++)
01892     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> jx = 0; jx&lt;dim1; jx++){
01893       avg += this-&gt;z[jy][jz][jx];
01894     }
01895   <span class="keywordflow">return</span> avg/(dim3*dim1);
01896 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="Image::globalSum" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void Image::globalSum </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classImage.html">Image</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>Q</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>Params &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>params</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Performs global sum of an image the global sum is only performed for the part if the image which is inside the region of support <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>Q</em>&nbsp;</td><td>Q image which provides the region of support </td></tr>
    <tr><td valign=top><em>params</em>&nbsp;</td><td>instance of Params class </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="Image_8cpp-source.html#l01967">1967</a> of file <a class="el" href="Image_8cpp-source.html">Image.cpp</a>.
<p>
<div class="fragment"><pre>01968 {
01969   <span class="keywordtype">int</span> buffSize =params.geometry.nX*params.geometry.nZ*
01970     Constant::GLOBALSUMSLICENUM; 
01971   <span class="keywordtype">int</span> sliceSize = params.geometry.nX*params.geometry.nZ;
01972   <span class="keywordtype">float</span> *sendBuff=<span class="keyword">new</span> <span class="keywordtype">float</span>[buffSize]; <span class="comment">//send buffer</span>
01973   <span class="keywordtype">float</span> *revBuff= <span class="keyword">new</span> <span class="keywordtype">float</span>[buffSize]; <span class="comment">//receive buffer</span>
01974   <span class="keywordtype">int</span> sendBuffIndex = 0;
01975   <span class="keywordtype">bool</span> enoughBuff = <span class="keyword">true</span>; <span class="comment">//if buffer has enough space for the next slice</span>
01976 
01977 
01978   <span class="keywordtype">int</span> ny = 0; <span class="comment">//init slice number</span>
01979   <span class="keywordflow">while</span>(ny&lt;params.geometry.nY){
01980     <span class="comment">//fill the send buffer</span>
01981     <span class="comment">// when elements of Q != 0</span>
01982     <span class="keywordtype">int</span> iyStart = ny; <span class="comment">//starting slice</span>
01983     <span class="keywordflow">while</span>(ny&lt;params.geometry.nY &amp;&amp; enoughBuff){      
01984       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> nz = 0; nz&lt; params.geometry.nZ; nz++)
01985         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> nx =0; nx &lt; params.geometry.nX; nx++){
01986           <span class="keywordflow">if</span>(Q(nx,ny,nz)!=0){ <span class="comment">//fill the send buffer</span>
01987             sendBuff[sendBuffIndex] = (*this)(nx,ny,nz);
01988             sendBuffIndex ++;
01989           }
01990         }
01991       <span class="comment">//check if the buffer enough for next slice</span>
01992       enoughBuff = (buffSize - sendBuffIndex) &gt; sliceSize; 
01993       ny++;<span class="comment">//next slice</span>
01994     }
01995     <span class="keywordtype">int</span> iyEnd = ny;<span class="comment">//end slice</span>
01996     <span class="comment">//Global sum</span>
01997     MPI::COMM_WORLD.Barrier(); 
01998     MPI::COMM_WORLD.Allreduce(sendBuff, revBuff, sendBuffIndex, 
01999                               MPI::FLOAT, MPI::SUM);
02000     <span class="comment">//using receive buffer to fill the image</span>
02001     <span class="keywordtype">int</span>  revBuffIndex = 0;
02002     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iy = iyStart; iy&lt;iyEnd; iy++) <span class="comment">//slice number</span>
02003       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iz = 0; iz&lt;params.geometry.nZ; iz++)
02004         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ix = 0; ix&lt;params.geometry.nX; ix ++){
02005           <span class="keywordflow">if</span>(Q(ix,iy,iz)!=0){<span class="comment">//file image</span>
02006             (*this)(ix,iy,iz) = revBuff[revBuffIndex];
02007             revBuffIndex ++;
02008           }
02009         }
02010     <span class="keywordflow">if</span>(revBuffIndex!=sendBuffIndex) 
02011       cout&lt;&lt;<span class="stringliteral">"something wrong in nu global sum"</span>&lt;&lt;endl;
02012     <span class="comment">//reset the values</span>
02013     sendBuffIndex = 0;
02014     enoughBuff = <span class="keyword">true</span>;
02015   }
02016   <span class="keyword">delete</span> []sendBuff;
02017   <span class="keyword">delete</span> []revBuff;
02018 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="Image::globalSum" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void Image::globalSum </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Params &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>params</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Performs global sum of an image slice by slice <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>params</em>&nbsp;</td><td>instance of Params class </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="Image_8cpp-source.html#l01929">1929</a> of file <a class="el" href="Image_8cpp-source.html">Image.cpp</a>.
<p>
Referenced by <a class="el" href="AlgorithmOSEM_8cpp-source.html#l00166">AlgorithmOSEM::oneIteration()</a>.
<p>
<div class="fragment"><pre>01930 {
01931   <span class="keywordtype">float</span> workArr[params.geometry.nX*params.geometry.nZ];
01932 
01933   time_t timeGlobalSum1,  timeGlobalSum2;     
01934   <span class="keywordtype">double</span> timeGlobalSum;     
01935   timeGlobalSum1 = time((time_t *) 0);
01936   <span class="keywordtype">int</span> countT = 0;
01937   Status *status = Status::getStatus();
01938 
01939   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n1 = 0; n1&lt;params.geometry.nY; n1++) {
01940     memcpy(workArr, &amp;(this-&gt;z[n1][0][0]), <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)*
01941            params.geometry.nX*params.geometry.nZ);
01942     
01943     MPI::COMM_WORLD.Allreduce(workArr, &amp;(this-&gt;z[n1][0][0]) ,
01944                                params.geometry.nX*params.geometry.nZ , 
01945                               MPI::FLOAT, MPI::SUM);
01946 
01947     timeGlobalSum2 = time((time_t *) 0);
01948     timeGlobalSum = difftime(timeGlobalSum2,timeGlobalSum1);
01949 
01950     ++countT; <span class="comment">//increase count</span>
01951     <span class="keywordflow">if</span>(status-&gt;proc ==0) 
01952       <span class="keywordflow">if</span>(countT%10==0 &amp;&amp; params.frame.verbosity&gt;=2) 
01953         (cout&lt;&lt;countT&lt;&lt;<span class="stringliteral">" slices global sumed, spends time : "</span>
01954          &lt;&lt;timeGlobalSum&lt;&lt;<span class="stringliteral">" s"</span>&lt;&lt;endl).flush();
01955     
01956   }
01957   MPI::COMM_WORLD.Barrier(); <span class="comment">//prepare processes</span>
01958 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="Image::operator=" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="classImage.html">Image</a> &amp; Image::operator= </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classImage.html">Image</a> &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>img</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Image class constructor- =operator constructor. Used to copy another image. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>Image</em>&nbsp;</td><td>- Input Image instance to make copy of </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>N/A </dd></dl>
<dl compact><dt><b>See also:</b></dt><dd></dd></dl>

<p>
Definition at line <a class="el" href="Image_8cpp-source.html#l00125">125</a> of file <a class="el" href="Image_8cpp-source.html">Image.cpp</a>.
<p>
References imageFileInfo, <a class="el" href="Array3D_8hpp-source.html#l00078">Array3D&lt; T &gt;::operator=()</a>, and <a class="el" href="Image_8hpp-source.html#l00189">xml</a>.
<p>
<div class="fragment"><pre>00125                                   {
00126   <span class="comment">//memset(&amp;imageFileInfo, 0, sizeof(struct fileInfo));</span>
00127   <a class="code" href="classImage.html#o0">xml</a> = img.<a class="code" href="classImage.html#o0">xml</a>;
00128   imageFileInfo = img.<a class="code" href="classImage.html#r0">imageFileInfo</a>;
00129   this-&gt;<a class="code" href="classArray3D.html#a5">Array3D&lt;float&gt;::operator=</a>(img);
00130 
00131   <span class="keywordflow">return</span> (*this);
00132 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="Image::putOrderSlice" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void Image::putOrderSlice </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>iz</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>float *&nbsp;</td>
          <td class="mdname" nowrap> <em>array</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Put an 1d buffer into a slice of 3d image on xy plane the size of the buffer should be same as size of the slice of the image <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>iz</em>&nbsp;</td><td>index in z axis </td></tr>
    <tr><td valign=top><em>array</em>&nbsp;</td><td>the pointer to 1d buffer </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="Image_8cpp-source.html#l01907">1907</a> of file <a class="el" href="Image_8cpp-source.html">Image.cpp</a>.
<p>
<div class="fragment"><pre>01908 {
01909    
01910   <span class="keywordtype">int</span> i2 = iz;<span class="comment">//z index in the middle</span>
01911        
01912   <span class="keywordflow">if</span>(i2&lt;0||dim2&lt;=i2){ <span class="comment">//check index</span>
01913     cout &lt;&lt; <span class="stringliteral">"Bad index "</span>&lt;&lt;i2&lt;&lt;<span class="stringliteral">" &gt; "</span>;
01914     cout &lt;&lt;dim2&lt;&lt; endl;
01915     <span class="keywordflow">return</span>;
01916   }
01917   <span class="keywordtype">int</span> index = 0, jz= iz;
01918   
01919   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> jy = 0; jy&lt;dim3; jy++)
01920     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> jx = 0; jx&lt;dim1; jx++){
01921       this-&gt;z[jy][jz][jx]= array[index];
01922       index ++;
01923     }
01924 
01925 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="Image::read" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool Image::read </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">string&nbsp;</td>
          <td class="mdname" nowrap> <em>filename</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="structParams_1_1Extensions.html">Params::Extensions</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>ext</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Read Method - reads the input file Constructs the image array by reading the specified file and its header. The file type of the input file is determined by the Extensions structure <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>filename</em>&nbsp;</td><td>- Input Image filename Extensions - Contains the accepted extensions for the different file types </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>true-if read was successful else flase </dd></dl>
<dl compact><dt><b>See also:</b></dt><dd>Params </dd></dl>

<p>
Definition at line <a class="el" href="Image_8cpp-source.html#l00241">241</a> of file <a class="el" href="Image_8cpp-source.html">Image.cpp</a>.
<p>
References <a class="el" href="Log_8hpp-source.html#l00079">Log::getLog()</a>, and <a class="el" href="Log_8hpp-source.html#l00052">Log::outputMessage()</a>.
<p>
<div class="fragment"><pre>00241                                                        {
00242   imageFileInfo.dataset_attr.hdrFileName = fileName;
00243   imageFileInfo.dataset_attr.ext = ext;
00244   <a class="code" href="classLog.html">Log</a> *log = <a class="code" href="classLog.html#e0">Log::getLog</a>();
00245 
00246   <span class="keywordflow">if</span>(readHdr()) {
00247                 
00248     <span class="keywordflow">if</span>(readData()) {
00249 <span class="preprocessor">#ifdef DEBUG3</span>
00250 <span class="preprocessor"></span>      cout &lt;&lt; <span class="stringliteral">"Image::read: Image read successful\n"</span>;
00251 <span class="preprocessor">#endif</span>
00252 <span class="preprocessor"></span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;
00253     } <span class="keywordflow">else</span> {
00254       log-&gt;<a class="code" href="classLog.html#a2">outputMessage</a>(<span class="stringliteral">"Image::read: Image read unsuccessful\n"</span>, 
00255                          FRAME, HIGH);
00256       <span class="keywordflow">return</span> <span class="keyword">false</span>;
00257     }
00258   } <span class="keywordflow">else</span> {
00259     log-&gt;<a class="code" href="classLog.html#a2">outputMessage</a>( <span class="stringliteral">"Image::read: Image read header failed\n"</span>, 
00260                         FRAME, HIGH);
00261     <span class="keywordflow">return</span> <span class="keyword">false</span>;
00262   }
00263 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="Image::scale" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void Image::scale </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Params &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>params</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>float&nbsp;</td>
          <td class="mdname" nowrap> <em>coeff</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Scales the mu image to proper unit <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>params</em>&nbsp;</td><td>Params object </td></tr>
    <tr><td valign=top><em>coeff</em>&nbsp;</td><td>coefficient to scale the image </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="Image_8cpp-source.html#l02025">2025</a> of file <a class="el" href="Image_8cpp-source.html">Image.cpp</a>.
<p>
<div class="fragment"><pre>02026 {
02027     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iy = 0; iy&lt;params.geometry.nY; iy++)
02028       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iz = 0; iz &lt; params.geometry.nZ; iz++)
02029         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ix =0; ix&lt; params.geometry.nX; ix++)
02030           (*this)(ix,iy,iz) *= coeff;
02031 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="Image::write" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool Image::write </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">string&nbsp;</td>
          <td class="mdname" nowrap> <em>filename</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>XMLTree &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>newTree</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="structParams_1_1Extensions.html">Params::Extensions</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>ext</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Write Method - Writes to the output file. If the fileType is "xml", the XMLTree passed to the method could be inserted into the header. Writes the Image header and data files. The filetype is determined either by the "fileType" parameter set in the Image constructor. If that is not defined, refers to the Extensions structure based on the extension of the filename passed to the method <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>filename</em>&nbsp;</td><td>- Output Image Header filename. Should have a valid extension based on the Extensions structure newTree - XMLTree to be inserted into the output header file Extensions - Contains the accepted extensions for the different file types </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>true-if read was successful else flase </dd></dl>
<dl compact><dt><b>See also:</b></dt><dd>Params </dd></dl>

<p>
Definition at line <a class="el" href="Image_8cpp-source.html#l00469">469</a> of file <a class="el" href="Image_8cpp-source.html">Image.cpp</a>.
<p>
References <a class="el" href="Image_8cpp-source.html#l00362">write()</a>, and <a class="el" href="Image_8hpp-source.html#l00189">xml</a>.
<p>
<div class="fragment"><pre>00470                                          {
00471   <span class="keywordflow">if</span>(<a class="code" href="classImage.html#o0">xml</a>.empty) {
00472 
00473 <span class="preprocessor">#ifdef DEBUG3</span>
00474 <span class="preprocessor"></span>    cout &lt;&lt; <span class="stringliteral">"Image::write: XML Tree is empty.. constructing a new tree\n"</span>;
00475 <span class="preprocessor">#endif</span>
00476 <span class="preprocessor"></span>    buildXMLTree();     
00477   }
00478 
00479   <span class="comment">// Inserting the Status or the Params xml trees under image ?? TBD...</span>
00480   <span class="keywordflow">if</span>(!<a class="code" href="classImage.html#o0">xml</a>.insertTree(<span class="stringliteral">"image"</span>, newTree, <span class="stringliteral">""</span>,<span class="stringliteral">""</span>,<span class="stringliteral">""</span>))
00481     <span class="keywordflow">return</span> <span class="keyword">false</span>;
00482   <span class="keywordflow">if</span> (!<a class="code" href="classImage.html#a8">write</a>(filename, ext)) {  
00483     <span class="keywordflow">return</span> <span class="keyword">false</span>;
00484   }
00485   <span class="keywordflow">return</span> <span class="keyword">true</span>;
00486 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="Image::write" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool Image::write </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">string&nbsp;</td>
          <td class="mdname" nowrap> <em>filename</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="structParams_1_1Extensions.html">Params::Extensions</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>ext</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="classImage.html">Image</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>Q</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>Params &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>params</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="classArray3D.html">Array3D</a>&lt; char &gt; &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>lambdaMask</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Write Method - Writes to the output file Writes the Image header and data files. The filetype is determined either by the "fileType" parameter set in the Image constructor. If that is not defined, refers to the Extensions structure based on the extension of the filename passed to the method <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>filename</em>&nbsp;</td><td>- Output Image Header filename. Should have a valid extension based on the Extensions structure Extensions - Contains the accepted extensions for the different file types </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>true-if read was successful else flase </dd></dl>
<dl compact><dt><b>See also:</b></dt><dd>Params </dd></dl>

<p>
Definition at line <a class="el" href="Image_8cpp-source.html#l00362">362</a> of file <a class="el" href="Image_8cpp-source.html">Image.cpp</a>.
<p>
Referenced by <a class="el" href="AlgorithmOSEM_8cpp-source.html#l00024">AlgorithmOSEM::reconstruct()</a>, and <a class="el" href="Image_8cpp-source.html#l00469">write()</a>.
<p>
<div class="fragment"><pre>00364 {
00365   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iz = 0; iz &lt; params.geometry.nZ; iz++)
00366     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iy = 0; iy&lt;params.geometry.nY; iy++)
00367       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ix =0; ix&lt; params.geometry.nX; ix++)
00368           (*this)(ix,iy,iz) *= lambdaMask(ix,iy,iz);
00369   
00370   <span class="keywordflow">return</span> (<a class="code" href="classImage.html#a8">write</a>(filename, ext));
00371 }
</pre></div>    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="o0" doxytag="Image::xml" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> XMLTree <a class="el" href="classImage.html#o0">Image::xml</a>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
XML Images will have a associated XMLTree with their header information 
<p>
Definition at line <a class="el" href="Image_8hpp-source.html#l00189">189</a> of file <a class="el" href="Image_8hpp-source.html">Image.hpp</a>.
<p>
Referenced by <a class="el" href="Image_8cpp-source.html#l00119">Image()</a>, <a class="el" href="Image_8cpp-source.html#l00125">operator=()</a>, and <a class="el" href="Image_8cpp-source.html#l00469">write()</a>.    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="Image_8hpp-source.html">Image.hpp</a><li><a class="el" href="Image_8cpp-source.html">Image.cpp</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Thu Dec 13 14:13:49 2007 for reconHRRT by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.5 </small></address>
</body>
</html>
