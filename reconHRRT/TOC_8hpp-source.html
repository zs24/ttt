<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>reconHRRT: TOC.hpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.5 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a>  | <span class="search"><u>S</u>earch&nbsp;for&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<h1>TOC.hpp</h1><div class="fragment"><pre>00001 <span class="preprocessor">#ifndef TOC_HPP</span>
00002 <span class="preprocessor"></span><span class="preprocessor">#define TOC_HPP</span>
00003 <span class="preprocessor"></span><span class="preprocessor">#include "IOConfig.hpp"</span>
00004 <span class="preprocessor">#include &lt;string&gt;</span>
00005 <span class="preprocessor">#include &lt;fstream&gt;</span>
00006 <span class="preprocessor">#include &lt;iostream&gt;</span>
00007 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
00008 <span class="preprocessor">#include &lt;sys/types.h&gt;</span>
00009 <span class="keyword">using</span> <span class="keyword">namespace </span>std;
<a name="l00014"></a><a class="code" href="classTOC.html">00014</a> <span class="keyword">class </span><a class="code" href="classTOC.html">TOC</a>
00015 {
00016   <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classHRRTHouseList.html">HRRTHouseList</a>;
00017 <span class="keyword">private</span>:
00018   string fileNameHC; <span class="comment">//fileName of  a specified .hc file</span>
00019   string fileNameTOC; <span class="comment">//fileName of the Toc file</span>
00020   <span class="comment">//  next few added 2006-08-30</span>
00021   string fileName_sing_fix; <span class="comment">//fileName of the Toc2 file</span>
00022   <span class="keywordtype">float</span> sing_fix_time;  <span class="comment">// after this time, fix singles</span>
00023   <span class="keywordtype">float</span> sing_fix_constant;      <span class="comment">// fix by exp(-sing_fix_constant*(time-sing_fix_time))</span>
00024   <span class="comment">// end of additions for 2006-08-30</span>
00025   <span class="keywordtype">bool</span> lookForZero; <span class="comment">//if there is a zero time tag in the list mode file</span>
00026    <span class="keywordtype">bool</span> missingZeroTag;
00027   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> TIMETAGPERSECOND = 1000;
00028   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> SAVEUNIT = 1; <span class="comment">//bytes</span>
00029   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> BYTEPERCOUNT = 8;
00030   <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> SKIP_OFFSET = 0;
00031   <span class="comment">//find the offset at or near the zero time tag</span>
00032   OFF_T findZeroOffset(string &amp; fileNameListMode);
00033   <span class="comment">//find the first time tag</span>
00034   <span class="keywordtype">int</span> findFirstTimeTag(string &amp; fileNameListMode, OFF_T &amp;offset);
00035   <span class="comment">//find the last time tag</span>
00036   <span class="keywordtype">int</span> findLastTimeTag(string &amp; fileNameListMode, OFF_T &amp;offset);
00042   <span class="keywordtype">bool</span> CreateTOC();
00043   <span class="comment">//if the head curve file doesn't exist</span>
00044   <span class="comment">//create TOC file directly from the list mode file</span>
00045   <span class="keywordtype">bool</span> createTOCFromListModeFile();
00046 <span class="keyword">public</span>:
00053   <a class="code" href="classTOC.html#a0">TOC</a>(string &amp; fileName, string &amp; pathTOC);
00059   OFF_T <a class="code" href="classTOC.html#a1">estimateOffset</a>(<span class="keywordtype">int</span> timeTag);
<a name="l00064"></a><a class="code" href="classTOC.html#e0">00064</a>   <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="classTOC.html#e0">isTimeTag</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> * b) 
00065   {
00066     <span class="keywordflow">return</span> ( ((b[1] &amp; 0x4000 )&gt;&gt;14) ==1 &amp;&amp; (b[2] &amp; 0xe000) == 0x8000);
00067   }
<a name="l00073"></a><a class="code" href="classTOC.html#e1">00073</a>   <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classTOC.html#e1">processTimeTag</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *b)
00074   {
00075     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> b2=b[2], b0=b[0], mask=0x1fff;
00076     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> bMask = (b2 &amp; mask)&lt;&lt;16;
00077     <span class="keywordflow">return</span> (bMask+b0);
00078   }
00086   <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="classTOC.html#e2">findPreviousEvent</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *b, FILE *lun);
00093   <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="classTOC.html#e3">findNextEvent</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *b, FILE * lun);
00094 
00103   <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="classTOC.html#e4">checkSync</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *b, FILE *lun, <span class="keywordtype">long</span> &amp; nSkip);
00104   <span class="keyword">static</span> <span class="keywordtype">bool</span> checkSyncReverse(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *b, FILE *lun, <span class="keywordtype">long</span> &amp; nSkip);
00105 
00122   <span class="keywordtype">int</span> <a class="code" href="classTOC.html#a2">getFrameStopTimeTag</a>(<span class="keywordtype">int</span> requestedFrameStopTimeTag);
00123   
00130   OFF_T <a class="code" href="classTOC.html#a3">getZeroOffset</a>();
00131 
<a name="l00139"></a><a class="code" href="classTOC.html#a4">00139</a>   <span class="keywordtype">bool</span> <a class="code" href="classTOC.html#a4">isLookForZero</a>() {
00140       <span class="keywordflow">return</span> this-&gt;lookForZero;
00141   }
00142 
00149   <span class="keywordtype">bool</span> <a class="code" href="classTOC.html#a5">setLookForZero</a>(); 
00150 
00151   <span class="keywordtype">float</span> get_fix_sing_time();
00152   <span class="keywordtype">float</span> get_fix_sing_constant();
00153   <span class="keywordtype">float</span> getEstimatedCounts(<span class="keywordtype">long</span> frameStartTimeTag, <span class="keywordtype">long</span> frameStopTimeTag);
00154  
00155 };
00156 
00157 <span class="preprocessor">#endif</span>
00158 <span class="preprocessor"></span>    
00159    
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Thu Dec 13 14:13:48 2007 for reconHRRT by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.5 </small></address>
</body>
</html>
